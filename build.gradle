
/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
plugins {
    id 'java'
    id 'jacoco'
}
group 'org.atlas.prototype.tests'
version '1.0.0'
sourceCompatibility = 11
targetCompatibility = 11
repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
}
task jacocoMerge(type: JacocoMerge) {

    executionData fileTree(project.buildDir.absolutePath).include("**/jacoco/**/test.exec")
}

task doComplete() {
    println "complete test"

}
task generateReport(type: TestReport) {
    destinationDir = file("$buildDir/reports/full")
    reportOn { -> file("$buildDir/test/bin").listFiles() }
    finalizedBy(jacocoTestReport)
}

test {

    if (project.hasProperty("testStage")) {
        binResultsDir = new File("$buildDir/test/bin/$testStage")
    }

    finalizedBy(generateReport)

//    finalizedBy(jacocoTestReport)

}


jacocoTestReport {
    dependsOn(jacocoMerge)
    reports {
        html.enabled = true
    }
}

//
